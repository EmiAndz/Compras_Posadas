<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ubicaciones | Compras Posadas</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'custom-green': '#10b981',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 py-3">
            <!-- Barra de búsqueda global -->
            <div class="mb-4">
                <form class="search" role="search" aria-label="Buscar productos" id="searchForm" style="max-width: none; background: #f8f9fa;">
                    <div class="search__container">
                        <div class="search__input-wrapper">
                            <input 
                                type="search" 
                                placeholder="Buscar por producto, categoría, tienda" 
                                aria-label="Buscar producto"
                                id="searchInput"
                                autocomplete="off"
                            />
                            <button type="button" class="search__clear-btn" id="clearSearchBtn" aria-label="Limpiar búsqueda" style="display: none;">
                                <span>×</span>
                            </button>
                            <button type="submit" class="btn-icon" aria-label="Buscar">
                                <svg width="20" height="20" viewBox="0 0 22 22" fill="none">
                                    <circle cx="10" cy="10" r="8" stroke="#fff" stroke-width="2"/>
                                    <line x1="16" y1="16" x2="21" y2="21" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </button>
                        </div>
                        
                        <!-- Dropdown de sugerencias debajo del input -->
                        <div class="search__dropdown" id="searchDropdown" style="display: none;">
                            <div class="search__suggestion-item" id="searchSuggestion">
                                <span class="search__suggestion-text" id="suggestionText"></span>
                                <div class="search__loading" id="searchLoading" style="display: none;">
                                    <div class="search__spinner"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <button onclick="history.back()" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <div>
                        <h1 class="text-xl font-bold text-gray-900">Ubicaciones</h1>
                        <p class="text-sm text-gray-500">Encuentra todas nuestras tiendas</p>
                    </div>
                </div>
                
                <!-- View Toggle -->
                <div class="flex bg-gray-100 rounded-lg p-1">
                    <button id="listViewBtn" class="px-3 py-1 rounded-md text-sm font-medium transition-all bg-white text-gray-900 shadow-sm">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" class="inline mr-1">
                            <path d="M8 6H21M8 12H21M8 18H21M3 6H3.01M3 12H3.01M3 18H3.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Lista
                    </button>
                    <button id="mapViewBtn" class="px-3 py-1 rounded-md text-sm font-medium transition-all text-gray-600 hover:text-gray-900">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" class="inline mr-1">
                            <path d="M21 10C21 17 12 23 12 23S3 17 3 10C3 7.61305 3.94821 5.32387 5.63604 3.63604C7.32387 1.94821 9.61305 1 12 1C14.3869 1 16.6761 1.94821 18.3639 3.63604C20.0518 5.32387 21 7.61305 21 10Z" stroke="currentColor" stroke-width="2"/>
                            <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        Mapa
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Search and Filters -->
    <div class="max-w-7xl mx-auto px-4 py-4">
        <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
            <div class="flex flex-col lg:flex-row gap-4">
                <!-- Search Bar -->
                <div class="flex-1">
                    <div class="relative">
                        <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                            <path d="m21 21-4.35-4.35" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        <input 
                            type="text" 
                            id="searchInput" 
                            placeholder="Buscar por nombre, barrio o dirección..."
                            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-custom-green focus:border-transparent">
                    </div>
                </div>

                <!-- Neighborhood Filter -->
                <div class="lg:w-48">
                    <select id="neighborhoodFilter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-custom-green focus:border-transparent">
                        <option value="">Todos los barrios</option>
                    </select>
                </div>

                <!-- Category Filter -->
                <div class="lg:w-48">
                    <select id="categoryFilter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-custom-green focus:border-transparent">
                        <option value="">Todas las categorías</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Area -->
    <div class="max-w-7xl mx-auto px-4 pb-24">
        <!-- List View -->
        <div id="listView" class="grid gap-4 md:gap-6">
            <!-- Location cards will be inserted here -->
        </div>

        <!-- Map View -->
        <div id="mapView" class="hidden">
            <div class="bg-white rounded-lg shadow-sm p-6 text-center">
                <div class="mb-4">
                    <svg class="mx-auto h-16 w-16 text-gray-400" viewBox="0 0 24 24" fill="none">
                        <path d="M21 10C21 17 12 23 12 23S3 17 3 10C3 7.61305 3.94821 5.32387 5.63604 3.63604C7.32387 1.94821 9.61305 1 12 1C14.3869 1 16.6761 1.94821 18.3639 3.63604C20.0518 5.32387 21 7.61305 21 10Z" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Vista de Mapa</h3>
                <p class="text-gray-600 mb-4">Aquí se mostraría un mapa interactivo con todas las ubicaciones de las tiendas.</p>
                <p class="text-sm text-gray-500">Para una implementación completa, se puede integrar con Google Maps o Leaflet.</p>
            </div>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="text-center py-12">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-custom-green"></div>
            <p class="mt-4 text-gray-600">Cargando ubicaciones...</p>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden text-center py-12">
            <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" viewBox="0 0 24 24" fill="none">
                <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                <path d="m21 21-4.35-4.35" stroke="currentColor" stroke-width="2"/>
            </svg>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">No se encontraron ubicaciones</h3>
            <p class="text-gray-600">Intenta cambiar los filtros de búsqueda.</p>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="index.html" class="bottom-nav__item">
            <svg class="bottom-nav__icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <polyline points="9,22 9,12 15,12 15,22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Home</span>
        </a>
        
        <a href="tiendas.html" class="bottom-nav__item">
            <svg class="bottom-nav__icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M21 20C21 18.9391 20.5786 17.9217 19.8284 17.1716C19.0783 16.4214 18.0609 16 17 16H9C7.93913 16 6.92172 16.4214 6.17157 17.1716C5.42143 17.9217 5 18.9391 5 20M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M19 21V19C19 18.1974 18.7205 17.4204 18.2207 16.8056C17.7209 16.1908 17.0332 15.7759 16.26 15.64M15 3.13C15.7739 3.26531 16.4622 3.68167 16.9629 4.29790C17.4636 4.91413 17.7436 5.69240 17.7436 6.49635C17.7436 7.30030 17.4636 8.07857 16.9629 8.69480C16.4622 9.31103 15.7739 9.72739 15 9.86270" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Tiendas</span>
        </a>
        
        <a href="ubicaciones.html" class="bottom-nav__item bottom-nav__item--active">
            <svg class="bottom-nav__icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M21 10C21 17 12 23 12 23S3 17 3 10C3 7.61305 3.94821 5.32387 5.63604 3.63604C7.32387 1.94821 9.61305 1 12 1C14.3869 1 16.6761 1.94821 18.3639 3.63604C20.0518 5.32387 21 7.61305 21 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span>Ubicaciones</span>
        </a>
        
        <a href="#" class="bottom-nav__item">
            <svg class="bottom-nav__icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M3 3H5L5.4 5M7 13H17L21 5H5.4M7 13L5.4 5M7 13L4.7 15.3C4.3 15.7 4.6 16.5 5.1 16.5H17M17 13V19C17 19.5304 16.7893 20.0391 16.4142 20.4142C16.0391 20.7893 15.5304 21 15 21H9C8.46957 21 7.96086 20.7893 7.58579 20.4142C7.21071 20.0391 7 19.5304 7 19V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Carrito</span>
        </a>
        
        <a href="#" class="bottom-nav__item">
            <svg class="bottom-nav__icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Perfil</span>
        </a>
    </nav>

    <!-- Supabase SDK -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Scripts de la aplicación -->
    <script src="assets/js/config/supabase.js"></script>
    <script src="assets/js/global-search.js"></script>
    <script src="assets/js/ubicaciones.js"></script>
</body>
</html>